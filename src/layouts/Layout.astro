---
import NavBar from '../components/NavBar.astro';
import Header from '../components/Header.astro';
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/src/assets/logo.svg" />
    <meta name="generator" content={Astro.generator} />
    <title>ISOLA</title>
    <link rel="stylesheet" href="/src/styles/global.css" />
    <link rel="stylesheet" href="/src/styles/NavBar.css" />
    <link rel="stylesheet" href="/src/styles/Header.css" />
  </head>
  <body>
    <NavBar />
    <Header />
  </body>
</html>

<script is:inline>
  (function () {
    const navScaleEl = document.querySelector('.navbar-scale');
    const marqueeScaleEl = document.querySelector('.navbar__marquee-scale');
    const headerScaleEl = document.querySelector('.header-scale');

    let lastDpr = window.devicePixelRatio || 1;

    function applyScales() {
      const dpr = window.devicePixelRatio || 1;
      const scale = 1 / dpr;

      // Navbar scaling
      if (navScaleEl) {
        navScaleEl.style.width = dpr * 100 + 'vw';
        navScaleEl.style.transform = `translateX(-50%) scale(${scale})`;
      }

      // Marquee scaling (centered, DPR-safe)
      if (marqueeScaleEl) {
        marqueeScaleEl.style.width = dpr * 100 + 'vw';
        marqueeScaleEl.style.transform = `translate(-50%, -50%) scale(${scale})`;
      }

      // Header scaling (if exists)
      if (headerScaleEl) {
        headerScaleEl.style.transform = `translate(-50%, -50%) scale(${scale})`;
      }

      // Scale marquee padding (16px base)
      document.documentElement.style.setProperty(
        '--marquee-pad',
        `${16 / dpr}px`
      );

      // Scale navbar top position (32px base)
      document.documentElement.style.setProperty(
        '--navbar-top',
        `${32 / dpr}px`
      );
    }

    function updateIfNeeded() {
      const dpr = window.devicePixelRatio || 1;
      if (Math.abs(dpr - lastDpr) < 1e-6) return;
      lastDpr = dpr;
      applyScales();
    }

    applyScales();
    window.addEventListener('resize', updateIfNeeded);
    setInterval(updateIfNeeded, 250);
  })();
</script>
